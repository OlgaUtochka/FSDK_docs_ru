# Лицензии Face SDK

Доступны следующие типы лицензий: 

* По типу активации: 
    * [Онлайн](#онлайн-лицензии) – требуется подключение к Интернету для активации и периодического подтверждения, возможен перенос на другие устройства
    * [Оффлайн](#оффлайн-лицензии) – привязка к устройству или USB-токену, возможность переноса между устройствами отсутствует

* По типу привязки: 
    * [Application ID](#application-id) – привязка к iOS- или Android-приложению
    * Hardware ID – привязка к сигнатуре устройства
    * [USB-токен](#usb-токен) – устройство, используемое вместо стандартного файла лицензии

Если у Вас остались какие-либо вопросы, напишите нам: face@3divi.com

## Активация лицензии

### Онлайн лицензии

* По умолчанию рабочей директорией для онлайн лицензии является каталог *license*. При необходимости можно использовать другую директорию – все приложения, использующие *3DiVi Face SDK*, должны иметь к этой директории доступ на чтение и запись. Скопируйте в эту директорию файлы `log_params.xml` и `net_params.xml` из каталога *license*.
* Скачайте файл лицензии с сервера онлайн лицензий.
* Скопируйте файл лицензии в рабочую директорию онлайн лицензии и переименуйте его в `3divi_face_sdk.lic`.
* При вызове `FacerecService.createService` передайте путь до рабочей директории онлайн лицензии в аргументе `license_dir` (можно оставить пустым, если используется каталог по умолчанию).

Пока выполняется одно или несколько приложений, использующих *3DiVi Face SDK* с онлайн лицензией, файл лицензии будет регулярно обновляться (в фоновом процессе). Обновление лицензии включает в себя продление срока действия лицензии и, при необходимости, изменение ключа оборудования.

Параметры сети, используемые при обновлении лицензии, хранятся в файле `net_params.xml`:
* `timeout` – таймаут в секундах
* `use_system_proxy` – `yes` или `no`, поставьте `yes`, чтобы использовать системные настройки прокси
* `no_proxy_for_server` – `yes` или `no`, поставьте `yes`, чтобы не использовать прокси
* `proxy` – поставьте `url:port` для использования прокси, при условии, что для параметров `use_system_proxy` и `no_proxy_for_server` был выбран вариант `no`

### Оффлайн лицензии

* Распакуйте архив с дистрибутивом в любую директорию на вашем устройстве (см. [Приступая к работе](../README_ru.md#приступая-к-работе)).
* На используемом компьютере запустите в консоли утилиту *get_license*. Она находится в каталоге *bin*.
* Отправьте созданный файл `3divi_face_sdk.lic` поставщику программного обеспечения (компания *3DiVi*): свяжитесь с Вашим личным менеджером или напишите нам через форму обратной связи [на сайте 3DiVi Face SDK](https://face.3divi.com/ru/contact_us).
* Поставщик программного обеспечения отправит вам файл лицензии.
* Поместите файл лицензии в директорию *license* под именем `3divi_face_sdk.lic`.

## Привязка лицензии 

### Application ID

Вы можете привязать лицензию *Face SDK* к разработанному мобильному приложению. В этом случае пользователям Вашего приложения не понадобится приобретать или активировать лицензию. Для привязки лицензии Вам потребуется указать идентификатор приложения (`android_app_id` для Android-приложения или `ios_app_id` для iOS-приложения). Идентификатор приложения необходимо получать **тогда, когда приложение подписано для релиза**, в противном случае идентификатор изменится, и лицензия станет недействительной.

Чтобы получить идентификатор приложения, вызовите метод `FacerecService.getLicenseState` в приложении и выведите поле `android_app_id` или `ios_app_id` результата в *logcat*. Приобретите лицензию для Вашего приложения, указав полученный идентификатор. Используйте этот файл лицензии в приложении. Теперь Ваше приложение будет работать на любых Android/iOS-устройствах (в зависимости от целевой платформы). Одну и ту же лицензию нельзя использовать для нескольких приложений (разные приложения имеют разный идентификатор, и для каждого приложения должна быть своя лицензия).

### USB-токен 

USB-токен — это физическое устройство, которое может использоваться вместо стандарного файла лицензии. Как и файл лицензии, USB-токен содержит информацию о количестве приобретенных компонент *Face SDK*. В отличие от файла лицензии, USB-токен не привязывается к сигнатуре аппаратного оборудования — достаточно вставить USB-токен в используемое устройство. USB-токен защищен от копирования. Один USB-токен может быть использован только одним процессом, т.е. для запуска еще одного процесса потребуется еще один USB-токен.

Для лицензирования Face SDK с USB-токеном вместо файла лицензии необходимо воспользоваться одним из перечисленных ниже вариантов:
* в параметре `license_dir` функции `FacerecService.createService` указать `0x436e9514-hardware-key-serial-<key>`
* в файле `3divi_face_sdk.lic` заменить стандартное содержимое лицензии на строку `hardware_key_serial <key>`

где `key` — серийный номер USB-токена. Пример: `senselock1234560000000f7e`

В случае, если USB-токен с указанным серийным номером не обнаружен, в тексте исключения, выброшенного методом `FacerecService.createService`, будет приведен список всех доступных USB-токенов с их серийными номерами.

Поддержка USB-токенов добавлена в следующих сборках:
* Linux x86_32
* Linux x86_64
* Windows x86_32
* Windows x86_64
